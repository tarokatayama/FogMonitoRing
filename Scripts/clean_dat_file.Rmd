---
title: "Clean CR800 .dat data file"
author: "Taro Katayama & Brent Wilder"
date: '2022-06-10'
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r}
library(plyr)
library(tidyverse)
library(lubridate)
#library(mapview)
#mapviewOptions(fgb = FALSE)
#library(sf)
library(knitr)
library(Kendall)
library(zoo)
library(gridExtra)
library(readr)
#install.packages("janitor")
library(janitor)
```

```{r}

getwd()
setwd()

stations = list("TP", "SB", "NN", "EB")

for(i in stations){
#combine csv files from raw data folder
  SB_files = list.files(path = "./raw_data/[i]/", pattern= "*.dat", full.names = TRUE)

# turn combination csv files to combined data frame
SB<- SB_files %>%
  ldply(read.csv, skip = 1, stringsAsFactors = TRUE)

#Take out the first two rows
SB_cleanup<-SB[-c(1,2), ]

#pull only unique rows
SB_Processed<-unique(SB_cleanup)
}

```

```{r}
batteryplot<- ggplot(spicyraw, aes(x=TIMESTAMP, y=BattV_Avg))+
  geom_point() + 
batteryplot

lwsinitial<- ggplot(spicyraw, aes(x=TIMESTAMP, y= LWmV_17ft_Avg))+
  geom_point() + 
  
lwsinitial

spicyraw2 <- spicy_ultimate %>%
  mutate(day = date(TIMESTAMP),
         leaf = as.numeric(LWmV_17ft_Avg),
         hour = hour(TIMESTAMP))

spicyraw2$day <- as.factor(spicyraw2$day)

days <- unique(spicyraw2$day)

for(i in length(days)) {
  
  daydata <- filter(spicyraw2$day == days[i])
  
  ggplot(data = daydata,
         mapping = aes(x = hour,
                       y = LWmV_17ft_Avg))
  ggsave(filename = paste0('plotday', days[i], '.png'))
}

lapply(days, ggsave(ggplot(...)))

ggplot(data = spicyraw2,
       aes(x = hour, y = LWmV_17ft_Avg, color = day)) + 
  geom_point() +
  scale_y_discrete(breaks = seq(200, 1000, 100)) + 
  facet_wrap(~day) + 
  theme(axis.text.x = element_text(angle = 90))

View(spicyraw2)



spicyraw3 <- pivot_longer(spicyraw2, BattV_Avg:LWMWet_66ft_Tot,  names_to = 'data_type', values_to = 'value')

ggplot(data = spicyraw3,
       mapping = aes(x = TIMESTAMP, y = value)) + 
  geom_point() + 
  facet_wrap(~data_type)



spicyraw4 <- spicyraw2 %>%
  select(AirT_C_Avg,AirT_C_Std, TIMESTAMP) %>%
  ggplot(., 
         mapping = aes(x = TIMESTAMP, y = AirT_C_Avg)) + 
  geom_point()+
  geom_errorbar()

ggplot(data = filter(sst, year %in% tenyrs), 
       mapping = aes(x = year, y = surface_mean)) + 
  geom_linerange(mapping = aes(x = year, 
                               ymin = (surface_mean - surface_SD),
                               ymax = (surface_mean + surface_SD)),
                 color = 'gray70', size = 1) +
  geom_point(size = 2, color = '#440154FF') 

```

