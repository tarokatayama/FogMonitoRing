---
title: "exploration1"
author: "Taro Katayama"
date: '2022-06-14'
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(lubridate)
#install.packages('gganimate')
#install.packages('gifski')
library(gganimate)
library(gifski)
```

```{r}
SB_Processed<- read.csv("./processed_data/SB/SB_processed_CR800.csv")
SB_Processed<- SB_Processed%>%
  mutate(Station="Spicy_Bunker")

TP_Processed<- read.csv("./processed_data/TP/TP_processed_CR800.csv")
TP_Processed<- TP_Processed%>%
  mutate(Station="Tide_Pool")

EB_Processed<- read.csv("./processed_data/EB/EB_processed_CR800.csv")
EB_Processed<- EB_Processed%>%
  mutate(Station="Event_Bluff")

NN_Processed<- read.csv("./processed_data/NN/NN_processed_CR800.csv")
NN_Processed<- NN_Processed%>%
  mutate(Station="New_New")

All_Sites<- rbind(SB_Processed, TP_Processed, EB_Processed, NN_Processed)

All_Sites$TIMESTAMP<- as.POSIXct(All_Sites$TIMESTAMP, 
                                    tz="", format = "%Y-%m-%d %H:%M")
```


```{r}
theday <- '2022-06-20'

All_Sites_Day<- All_Sites%>%
  mutate(day=date(TIMESTAMP))%>%
  filter(day==theday)
  
  All_Sites_Day$TIMESTAMP<- as.POSIXct(All_Sites_Day$TIMESTAMP, 
                                    tz="", format = "%Y-%m-%d %H:%M")
```


```{r}
LWS_All_Sites_Plot<- ggplot(All_Sites_Day)+
  geom_line(aes(x= TIMESTAMP, y= LWmV_66ft_Avg, color=Station))+
  theme_bw()+
  theme(axis.text.x = element_text(angle = 90))+
  labs(x="June 20th", y="Leaf Wetness Sensor (mV)")+
  theme(legend.position = "bottom")
  
animateplot<- LWS_All_Sites_Plot+ transition_reveal(TIMESTAMP)
animate(animateplot)
anim_save('LWS_06_20.gif')



LWS_All_Sites_Plot
```


```{r}
compareplot<- ggplot()+
  geom_line(data = TP_day, aes(x = TIMESTAMP, y = LWmV_50ft_Avg))+
  geom_point(data= SB_day, aes(x = TIMESTAMP, y = LWmV_50ft_Avg)) +
  geom_line(data= NN_day, aes(x = TIMESTAMP, y = LWmV_17ft_Avg), color="red")+
  theme(axis.text.x = element_text(angle = 90))+
  theme_bw()+
  labs(x="June 20th", y="Leaf Wetness Sensor (mV)")+
  theme(legend.position = "right")
compareplot
```


```{r}

Weather_Function <- function(dataset, the_day, xvar, yvar){

  dataset <- dataset %>%
  mutate(day=date(TIMESTAMP))%>%
  filter(day==the_day)

  ggplot(data = dataset, aes(x = get(xvar), y = get(yvar), color = Station))+
  geom_line()+
  theme_bw()+
  theme(axis.text.x = element_text(angle = 90))
}

Weather_Function(All_Sites, '2022-06-27','TIMESTAMP', 'LWmV_66ft_Avg')

#different variables
'WindDir_D1_WVT'
'AirT_C_Avg'
'RH_Avg'
'LWmV_17ft_Avg'
'LWmV_50ft_Avg'
'LWmV_66ft_Avg'
'WS_ms_Avg'
```
